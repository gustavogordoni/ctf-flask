{% extends "base.html" %}

{% block title %}Fase 4 - IDOR{% endblock %}

{% block content %}
<h1>ğŸ“ FASE 4: INSECURE DIRECT OBJECT REFERENCE (IDOR)</h1>

<div class="warning">
    <strong>ğŸ¯ Objetivo:</strong> Encontre a flag explorando a vulnerabilidade de IDOR para acessar arquivos nÃ£o autorizados.
</div>

<div class="flag-box">
    <h3>ğŸ“– Dica:</h3>
    <p>O sistema permite visualizar documentos atravÃ©s de parÃ¢metros na URL...</p>
    <p>SerÃ¡ que vocÃª consegue acessar arquivos que nÃ£o deveria? ğŸ¤”</p>
    <p><em>Experimente manipular o nome do arquivo na URL...</em></p>
</div>

<h2>ğŸ“„ Sistema de Documentos</h2>
<p>Visualize os documentos disponÃ­veis:</p>

<div class="phase-nav">
    <a href="/documento?file=doc1.txt" class="phase-link">ğŸ“„ Documento 1</a>
    <a href="/documento?file=doc2.txt" class="phase-link">ğŸ“„ Documento 2</a>
</div>

<div class="flag-box">
    <h3>ğŸ’¡ Dicas Adicionais:</h3>
    <ul>
        <li>Observe como os arquivos sÃ£o referenciados na URL</li>
        <li>Que outros nomes de arquivo poderiam existir?</li>
        <li>E se tentasse acessar arquivos em outros diretÃ³rios?</li>
        <li>Arquivos importantes costumam ter nomes como "flag", "admin", "secret"...</li>
    </ul>
</div>

<div class="flag-box">
    <h3>ğŸ” Como Validar:</h3>
    <p>Quando encontrar a flag, submeta ela no formulÃ¡rio abaixo:</p>
    <form method="POST" action="/validate_flag">
        <input type="hidden" name="phase" value="4">
        <label for="flag">ğŸ´ Flag encontrada:</label><br>
        <input type="text" name="flag" id="flag" placeholder="flag{...}" required><br>
        <button type="submit">âœ… Validar Flag</button>
    </form>
</div>

<div class="code">
    <h4>ğŸ”¬ AnÃ¡lise TÃ©cnica:</h4>
    <p><strong>Vulnerabilidade:</strong> Insecure Direct Object Reference (IDOR)</p>
    <p><strong>Causa:</strong> Falta de validaÃ§Ã£o de acesso a recursos baseados em parÃ¢metros de entrada</p>
    <p><strong>Impacto:</strong> Acesso nÃ£o autorizado a arquivos, vazamento de informaÃ§Ãµes sensÃ­veis</p>
    <p><strong>PrevenÃ§Ã£o:</strong> Validar permissÃµes de acesso, usar IDs indiretos, implementar controle de acesso baseado em funÃ§Ã£o</p>
</div>
{% endblock %}