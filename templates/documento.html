{% extends "base.html" %}

{% block title %}Documento - {{ filename }}{% endblock %}

{% block content %}
<h1>ğŸ“„ VISUALIZADOR DE DOCUMENTOS</h1>

<div class="flag-box">
    <h3>ğŸ“ Arquivo: {{ filename }}</h3>
</div>

<div class="code">
    <h4>ğŸ“„ ConteÃºdo do arquivo:</h4>
    <pre>{{ content }}</pre>
</div>

{% if 'flag{' in content %}
    <div class="success">
        <h2>ğŸ‰ IDOR EXPLORADO COM SUCESSO!</h2>
        <p>VocÃª conseguiu acessar um arquivo nÃ£o autorizado!</p>
        <p>Esta Ã© uma vulnerabilidade grave que permite acesso a arquivos sensÃ­veis do sistema.</p>
    </div>
{% endif %}

<div class="phase-nav">
    <a href="/fase4" class="phase-link">ğŸ”™ Voltar para Fase 4</a>
    <a href="/documento?file=doc1.txt" class="phase-link">ğŸ“„ doc1.txt</a>
    <a href="/documento?file=doc2.txt" class="phase-link">ğŸ“„ doc2.txt</a>
</div>

<div class="warning">
    <h4>âš ï¸ ExplicaÃ§Ã£o da Vulnerabilidade IDOR:</h4>
    <p>O sistema nÃ£o validou se vocÃª tinha permissÃ£o para acessar o arquivo solicitado.</p>
    <p>Ao manipular o parÃ¢metro 'file' na URL, vocÃª conseguiu acessar arquivos nÃ£o autorizados.</p>
    <p>Em um sistema real, isso poderia expor informaÃ§Ãµes confidenciais, senhas, ou dados sensÃ­veis.</p>
</div>
{% endblock %}