{% extends "base.html" %}

{% block title %}Fase 2 - Broken Access Control{% endblock %}

{% block content %}
<h1>ğŸ” FASE 2: BROKEN ACCESS CONTROL</h1>

<div class="warning">
    <strong>ğŸ¯ Objetivo:</strong> Encontre uma forma de acessar informaÃ§Ãµes de administrador explorando falhas no controle de acesso.
</div>

<div class="flag-box">
    <h3>ğŸ“– Dica:</h3>
    <p>O sistema de perfis usa IDs na URL. SerÃ¡ que existe um ID especial para administradores? ğŸ¤”</p>
    <p>Experimente modificar parÃ¢metros na URL...</p>
</div>

<h2>ğŸ‘¤ Sistema de Perfis de UsuÃ¡rio</h2>
<p>Visualize perfis de usuÃ¡rios do sistema:</p>

<div class="flag-box">
    <a href="/perfil?id=1" class="phase-link">ğŸ‘¤ Ver Perfil do UsuÃ¡rio (ID: 1)</a>
</div>

<div class="flag-box">
    <h3>ğŸ” Como Validar:</h3>
    <p>Quando encontrar a flag, submeta ela no formulÃ¡rio abaixo:</p>
    <form method="POST" action="/validate_flag">
        <input type="hidden" name="phase" value="2">
        <label for="flag">ğŸ´ Flag encontrada:</label><br>
        <input type="text" name="flag" id="flag" placeholder="flag{...}" required><br>
        <button type="submit">âœ… Validar Flag</button>
    </form>
</div>

<div class="code">
    <h4>ğŸ”¬ AnÃ¡lise TÃ©cnica:</h4>
    <p><strong>Vulnerabilidade:</strong> Broken Access Control (BAC)</p>
    <p><strong>Causa:</strong> Falta de validaÃ§Ã£o de permissÃµes baseada em parÃ¢metros de URL</p>
    <p><strong>Impacto:</strong> EscalaÃ§Ã£o de privilÃ©gios, acesso nÃ£o autorizado a dados</p>
    <p><strong>PrevenÃ§Ã£o:</strong> Implementar controle de acesso adequado, validar permissÃµes, usar tokens de autorizaÃ§Ã£o</p>
</div>
{% endblock %}