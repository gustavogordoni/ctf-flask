{% extends "base.html" %}

{% block title %}Fase 3 - SQL Injection{% endblock %}

{% block content %}
<h1>ğŸ’‰ FASE 3: SQL INJECTION</h1>

<div class="warning">
    <strong>ğŸ¯ Objetivo:</strong> FaÃ§a login no sistema explorando uma vulnerabilidade de SQL Injection.
</div>

<div class="flag-box">
    <h3>ğŸ“– Dica:</h3>
    <p>O sistema usa uma consulta SQL insegura para validar credenciais...</p>
    <p>Que tal tentar fazer a consulta sempre retornar verdadeiro? ğŸ¤”</p>
    <p><em>Pense em como manipular a lÃ³gica da consulta SQL...</em></p>
</div>

<h2>ğŸ” Sistema de Login</h2>

{% if error %}
    <div class="error">
        <p>âŒ {{ error }}</p>
    </div>
{% endif %}

{% if sql_query %}
    <div class="code">
        <h4>ğŸ” Consulta SQL executada:</h4>
        <code>{{ sql_query }}</code>
    </div>
{% endif %}

<form method="POST">
    <label for="username">ğŸ‘¤ Nome de usuÃ¡rio:</label><br>
    <input type="text" name="username" id="username" required><br>
    
    <label for="password">ğŸ”’ Senha:</label><br>
    <input type="password" name="password" id="password" required><br>
    
    <button type="submit">ğŸ”‘ Fazer Login</button>
</form>

<div class="flag-box">
    <h3>ğŸ” Como Validar:</h3>
    <p>Quando encontrar a flag, submeta ela no formulÃ¡rio abaixo:</p>
    <form method="POST" action="/validate_flag">
        <input type="hidden" name="phase" value="3">
        <label for="flag">ğŸ´ Flag encontrada:</label><br>
        <input type="text" name="flag" id="flag" placeholder="flag{...}" required><br>
        <button type="submit">âœ… Validar Flag</button>
    </form>
</div>

<div class="code">
    <h4>ğŸ”¬ AnÃ¡lise TÃ©cnica:</h4>
    <p><strong>Vulnerabilidade:</strong> SQL Injection</p>
    <p><strong>Causa:</strong> ConcatenaÃ§Ã£o insegura de strings na consulta SQL</p>
    <p><strong>Impacto:</strong> Bypass de autenticaÃ§Ã£o, acesso nÃ£o autorizado, manipulaÃ§Ã£o de dados</p>
    <p><strong>PrevenÃ§Ã£o:</strong> Usar prepared statements, validar entrada, escapar caracteres especiais</p>
</div>
{% endblock %}